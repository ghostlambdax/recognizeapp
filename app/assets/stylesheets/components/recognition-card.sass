$recognitionCardContentBorderColor: #e8e9eb
$boundaryWidthForChangeInFontSize: 600px

#recognitions-wrapper.vertical
  min-width: 100%

  .recognition-card
    width: 100%
    box-sizing: border-box
    margin: 0 0 20px 0

    .to-wrapper
      margin-bottom: 10px
      .to
        width: auto

        li
          float: left

.recognition-card, .within-stream
  margin: 0 5% 30px
  width: 90%
  max-width: 800px
  box-shadow: 0 0 20px 1px rgba(0,0,0,.15)
  word-break: break-word

  p br:only-child
    display: none

  .recognition-action-wrapper
    min-height: 10px
    position: relative

  .comment-wrapper
    border-top: 1px solid #E6E6E6

    .loading
      padding: 0px 0px 5px

      .comment-avatar
        border-radius: 50%
        height: 25px
        width: 25px
        display: inline-block
        background-color: #f3f3f3
        margin-right: 10px

      .comment-text
        height: 15px
        width: 0
        transition: width 2s
        transition-timing-function: ease
        vertical-align: baseline
        background-color: #f3f3f3
        display: inline-block
        border-radius: 5px
        margin: 10px 0 5px 0
    li
      margin-bottom: 5px

      &:last-child
        margin-bottom: 0

    p
      margin: 0

    span
      font-size: 10px

    .button
      height: 40px
      margin-left: 15px
      margin-top: auto
      margin-bottom: 9px
      padding: 4px 6px!important

  .edit-controls
    input,
    textarea
      width: 224px

  .cross-company-card
    position: absolute
    top: -7px
    right: -7px
    background: no-repeat asset-data-url("recognition-card/external-network.png") 0 0
    width: 83px
    height: 88px
    text-indent: -9999px

  h4
    transform: translateZ(0)

  .from i,
  .to i
    color: $lighterGrayTextColor

  .recognition-badge
    width: auto

  a
    text-decoration: none

  $recognitionBg: #f4f4f4

  .content
    position: relative
    border-radius: 5px
    border: 1px solid #C0BFBF
    position: relative
    background: white
  .comments-wrapper
    h3
      float: none
  h3
    float: left
    font-size: 16px
    margin-bottom: 0
    margin-left: 3px

  .badge-wrapper
    display: block
    padding: 15px 0 10px
    border-bottom: 1px solid #E6E6E6
    border-radius: 5px 5px 0 0
    background: $recognitionBg
    min-height: 74px
    overflow: hidden
    position: relative
    max-height: 160px

    &:hover
      background: darken($recognitionBg, 5%)

  .image-wrapper
    z-index: 2
    width: 50px
    height: 50px
    background-size: 50px
    margin: -4px 0 0 15px
    border-radius: 102px
    box-shadow: 0 2px 5px 1px rgba(105, 104, 104, 0.73)
    position: absolute
    top: 21px
    left: 0

  .image-wrapper:hover
    box-shadow: 0 2px 5px 2px rgba(105, 104, 104, 0.73)

  .to-wrapper,
  .from-wrapper,
  .comment-wrapper
    padding: 15px
    .small-text
      font-size: 11px

  .to-wrapper
    padding: 0 0 0 85px
    width: 100%

    .recipient-list
      margin-bottom: 0
      display: flex
      flex-wrap: wrap

    li
      margin-bottom: 3px
      margin-right: 10px
      align-items: center
      display: flex

      &:only-child
        width: 100%

    .avatar
      width: 35px
      height: 35px
      margin-right: 5px

  .to-wrapper .image
    float: left
    margin-right: 5px
    max-width: 50px

  // common values referenced in both .message-outer and .overflow-overlay styles
  $expandedHeight: 250px // currently the same for mobile / desktop
  $messageMaxHeight: 500px
  $messageMaxHeightForPhone: 275px
  $overflowOverlayHeight: 100px
  $overflowOverlayHeightForPhone: 65px
  $overflowOverlayTop: $messageMaxHeight - $overflowOverlayHeight + 10
  $overflowOverlayTopForPhone: $messageMaxHeightForPhone - $overflowOverlayHeightForPhone + 10
  $transitionEffectForExpansion: 0.5s ease

  .message-outer
    max-height: $messageMaxHeight
    overflow: hidden
    position: relative
    margin-bottom: 10px
    transition: max-height $transitionEffectForExpansion

    @media (max-width: $phone)
      max-height: $messageMaxHeightForPhone

    &.expanded
      max-height: $messageMaxHeight + $expandedHeight
      @media (max-width: $phone)
        max-height: $messageMaxHeightForPhone + $expandedHeight

      .overflow-overlay
        top: $overflowOverlayTop + $expandedHeight
        @media (max-width: $phone)
          top: $overflowOverlayTopForPhone + $expandedHeight

  .overflow-overlay
    position: absolute
    height: $overflowOverlayHeight
    width: 100%
    display: flex
    flex-direction: column
    transition: top $transitionEffectForExpansion

    top: $overflowOverlayTop
    @media (max-width: $phone)
      top: $overflowOverlayTopForPhone

    .fade, .read-more
      // equal height based on parent container (overridden in mobile)
      flex: 0 0 50%

    .fade
      background-image: linear-gradient(to bottom, rgba(255,255,255,0), #fff)
      @media (max-width: $phone)
        flex-basis: 40%

    .read-more
      background-color: white
      padding-top: 5px

      @media (min-width: $boundaryWidthForChangeInFontSize)
        font-size: 16px

      // Note: this rule for this bottom container seems unnecessary (as opposed to the corresponding rule for .fade above)
      // but leaving for completeness
      @media (max-width: $phone)
        flex-basis: 60%

      svg
        color: $gray
        @media (max-width: $phone)
          margin-top: -5px

      > a
        display: flex
        flex-direction: column
        align-items: center // horizontal center, needed for icon

        > *
          // flex-basis: auto is needed for IE11, especially with flex-direction: column
          flex: 1 1 auto

    @media (max-width: $phone)
      height: $overflowOverlayHeightForPhone

  .message p
    @media (min-width: $boundaryWidthForChangeInFontSize)
      font-size: 25px
      line-height: 33px
      font-weight: 300

    margin-top: 5px

    &:empty
      display: none

    // override default 15px to prevent double margin from parent .message element's margin-bottom
    &:last-child
      margin-bottom: 5px

    ul:not(.single-recipient)
      li:only-child
        strong
          overflow: visible

      strong
        overflow: hidden
        white-space: nowrap
        text-overflow: ellipsis
        float: left

  .to-wrapper h4
    margin-bottom: 4px
    overflow: hidden
    text-overflow: ellipsis
    padding-bottom: 2px

  .to-wrapper p
    margin-top: 0
    margin-bottom: 0


  .from-wrapper dt
    position: absolute
    left: -9999px

  .from-wrapper dd
    margin-left: 0

  .time
    font-size: 11px

  .time,
  .from
    display: inline-block

  .bottom
    padding: 20px 15px 20px
    border-top: 1px solid $recognitionCardContentBorderColor

  .bottom a,
  .bottom p
    font-size: 12px

  .vote a,
  .counter
    font-size: 14px
    line-height: 14px
    cursor: pointer
    float: left
    margin-right: 10px
    width: 33px
    height: 12px
    @include voteButton()
    min-height: 24px

  .counter
    cursor: auto
    background: transparent
    color: #666 !important
    font-size: 20px
    box-shadow: none
    text-shadow: none

  .vote a:hover
    @include voteButtonHover()

  .vote a:active
    background: $btnBlueTopColor

  .bottom .who a,
  .bottom p
    text-decoration: none
    color: #666
    margin-bottom: 0

  .who h4
    font-size: 13px
    line-height: 13px

  .bottom .who p,
  .bottom .who a
    line-height: 13px

  .bottom .who a:hover
    text-decoration: underline

  .bottom .who
    float: left
    width: 80%
    margin-top: 3px
    .moreValidationNames
      position: relative
      .approval-list
        position: absolute
        left: 0
        border: 1px solid #C0BFBF
        border-radius: 5px
        width: 125px
        background-color: #f4f4f4
        display: none
        ul
          margin: 0
          padding: 5px
          li
            font-size: 12px
            color: #3F3F3F
            white-space: nowrap
            .more-approvers
              margin-top: 5px
              a
                color: #008ce5
  .vote-wrapper
    p
      margin: 0

  dl
    margin-bottom: 9px

    &:last-child
      margin-bottom: 0

  .options
    position: absolute
    bottom: 0
    right: 0

    .options-menu
      display: none

      li
        float: left
        margin-right: 5px

    .options-trigger
      padding: 10px
      margin: -9px -1px -8px -1px
      visibility: hidden
      float: right
      cursor: pointer
      padding: 10px
      text-indent: -9999px

      .gear-big
        background: no-repeat asset-data-url("recognition-card/gear-big.png") 0 0
        background-size: 15px
        width: 15px
        height: 15px
        position: relative
        left: -5px
        top: 2px

      .gear-small
        background: no-repeat asset-data-url("recognition-card/gear-small.png") 0 0
        background-size: 10px
        width: 10px
        height: 10px
        position: relative
        right: -5px

.touch .options .options-trigger
  visibility: visible

.recognition-card:not(.edit-open):hover .options-trigger,
.recognition-card.options-open .options-trigger
  visibility: visible


.recognition-card.options-open .options
  position: static
  margin-top: -30px



.recognition-card.options-open .options-menu
  display: block
  margin: 10px


.csstransitions .recognition-card.options-open .options-trigger .gear-big
  @include transform(rotate(30deg))

.csstransitions .recognition-card.options-open .options-trigger .gear-small
  @include transform(rotate(100deg))

html:not(.ios).csstransforms .recognition-card .gear
  @include transitionTransform(.2s, ease-in-out)

.recognition-card:hover .options .options-trigger
  display: block

.csstransitions .recognition-card .content
  @include transform(translate3d(0, 0, 0))

.recognition-card.edit-open .inner > div:not(.to-wrapper)
  display: none

.recognition-card form
  padding-bottom: 0
  @include flex-display()
  margin-bottom: 0

  .control-group
    margin-bottom: 0

  textarea
    margin-bottom: 10px

  .controls
    width: 100%
    flex: 1
.recognition-card #recognition-submit-wrapper
  .button
    margin-right: 7px

  a,
  a:hover
    color: white !important

  a:hover
    font-weight: 600

.ios .recognition-card
  .vote a,
  .counter
    line-height: 9px

@media (max-width: $tablet)
  .recognition-card
    margin-right: 0
    margin-left: 0
    width: 100%

    .to-wrapper .to
      width: 100%

      ul
        @include column-count(1)

@media (max-width: $boundaryWidthForChangeInFontSize)
  .recognition-card
    .to-wrapper li
      width: 100%
